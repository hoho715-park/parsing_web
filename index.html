<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JavaScript Code Parsing Web App</title>

<!-- JSZip -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<!-- Meriyah Parser -->
<script src="https://unpkg.com/meriyah/dist/meriyah.umd.js"></script>

<style>
    body {
        background: #121212;
        color: #ffffff;
        font-family: 'Segoe UI', sans-serif;
        margin: 0;
        padding: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    h1 {
        font-size: 32px;
        margin-bottom: 20px;
        color: #FFCC66;
        text-shadow: 0 0 8px rgba(255, 204, 102, 0.5);
    }

    /* ì—…ë¡œë“œ ë°•ìŠ¤ ë””ìì¸ */
    .upload-box {
        width: 90%;
        max-width: 600px;
        border: 2px dashed #555;
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        background: #1E1E1E;
        transition: 0.3s;
        cursor: pointer;
    }

    .upload-box:hover,
    .upload-box.dragover {
        border-color: #FFCC66;
        background: #2A2A2A;
        box-shadow: 0 0 12px rgba(255, 204, 102, 0.4);
    }

    input[type="file"] {
        display: none;
    }

    /* AST ì¶œë ¥ ë°•ìŠ¤ */
    #result {
        margin-top: 30px;
        width: 90%;
        max-width: 900px;
        height: 500px;
        background: #000;
        padding: 20px;
        border-radius: 10px;
        overflow-y: scroll;
        white-space: pre-wrap;
        font-size: 14px;
        font-family: Consolas, monospace;
        color: #00FF88;
        box-shadow: 0 0 15px rgba(0, 255, 136, 0.15);
    }

    /* ------------------------------
       âœ¨ ì»¤ìŠ¤í…€ ìŠ¤í¬ë¡¤ë°” ë””ìì¸
    ------------------------------ */
    #result::-webkit-scrollbar {
        width: 8px;
    }
    #result::-webkit-scrollbar-track {
        background: #202020;
        border-radius: 10px;
    }
    #result::-webkit-scrollbar-thumb {
        background: #00ff88cc;
        border-radius: 10px;
    }
    #result::-webkit-scrollbar-thumb:hover {
        background: #00ffaa;
    }
</style>
</head>

<body>

<h1>âš¡ JavaScript Code Parsing Web App</h1>

<!-- ì—…ë¡œë“œ ë°•ìŠ¤ -->
<label for="zipUpload" id="dropZone" class="upload-box">
    <p>ğŸ“¦ ZIP íŒŒì¼ ì—…ë¡œë“œ ë˜ëŠ” ëŒì–´ë‹¤ ë†“ê¸°</p>
    <p style="font-size: 13px; color:#aaa;">(JavaScript ì†ŒìŠ¤ì½”ë“œ í¬í•¨)</p>
    <button style="
        margin-top:10px;
        padding:10px 20px;
        border:none;
        border-radius:8px;
        background:#FFCC66;
        color:#000;
        cursor:pointer;
        font-weight:bold;
    ">íŒŒì¼ ì„ íƒ</button>
</label>

<input type="file" id="zipUpload" accept=".zip">

<!-- ê²°ê³¼ ì˜ì—­ -->
<div id="result">AST ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>

<script>
const dropZone = document.getElementById("dropZone");
const zipInput = document.getElementById("zipUpload");
const resultBox = document.getElementById("result");

/* ======================================
   1) DRAG & DROP ê¸°ëŠ¥
====================================== */
dropZone.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropZone.classList.add("dragover");
});
dropZone.addEventListener("dragleave", () => {
    dropZone.classList.remove("dragover");
});
dropZone.addEventListener("drop", (e) => {
    e.preventDefault();
    dropZone.classList.remove("dragover");

    const file = e.dataTransfer.files[0];
    if (file) handleZipFile(file);
});

/* íŒŒì¼ ì„ íƒ */
zipInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) handleZipFile(file);
});

/* ======================================
   2) ZIP íŒŒì¼ ë¡œë“œ ë° JS íŒŒì¼ íŒŒì‹±
====================================== */
async function handleZipFile(file) {
    resultBox.textContent = "ğŸ“¦ ZIP íŒŒì¼ì„ ë¶„ì„ ì¤‘...\n";

    const jszip = new JSZip();
    const zip = await jszip.loadAsync(file);

    const jsFiles = [];
    zip.forEach((path, entry) => {
        if (path.endsWith(".js")) jsFiles.push(entry);
    });

    if (jsFiles.length === 0) {
        resultBox.textContent = "âŒ ZIP ì•ˆì— JS íŒŒì¼(.js)ì´ ì—†ìŠµë‹ˆë‹¤!";
        return;
    }

    for (const entry of jsFiles) {
        const code = await entry.async("string");

        resultBox.textContent += `\nğŸ“„ íŒŒì¼: ${entry.name}\n`;

        try {
            // â­ Meriyahë¡œ íŒŒì‹±
            const ast = meriyah.parse(code, {
                module: true,
                next: true,
                loc: true,
                ranges: true
            });

            resultBox.textContent += JSON.stringify(ast, null, 2) + "\n\n";

        } catch (err) {
            resultBox.textContent += `âŒ íŒŒì‹± ì˜¤ë¥˜: ${err.message}\n`;
        }
    }
}
</script>

</body>
</html>
